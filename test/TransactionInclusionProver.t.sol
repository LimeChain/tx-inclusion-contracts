// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

import "./BaseTest.t.sol";

// libs
import "solady/src/utils/DynamicBufferLib.sol";
import "../src/lib/RLPWriter.sol";
import "../src/lib/RLPEncode.sol";
import "../src/lib/RLPReader.sol";
import "../src/lib/Utils.sol";

// contracts
import "../src/interfaces/IBlockhashStorage.sol";
import "../src/TrustedOracle.sol";
import "../src/TransactionInclusionProver.sol";

// structs
import "../src/structs/BlockData.sol";
import "../src/structs/ProverDto.sol";
import "../src/structs/TxReceipt.sol";
import "../src/structs/TxLog.sol";

contract TransactionInclusionProverTest is BaseTest {
    IBlockhashStorage public blockhashStorage;
    TransactionInclusionProver public prover;

    using RLPReader for bytes;
    using RLPReader for uint256;
    using RLPReader for RLPReader.RLPItem;
    using RLPReader for RLPReader.Iterator;

    function setUp() public override {
        super.setUp();
        blockhashStorage = new TrustedOracle();
        prover = new TransactionInclusionProver(address(blockhashStorage));
    }

    function testVerifyTrieProof1() public {
        TxReceipt memory txReceipt = _getTxReceipt1();

        bytes memory bytesReceipt = Utils.encodeReceipt(txReceipt);
        bytes memory expectedValue = bytesReceipt;
        if (txReceipt.receiptType > 0) {
            expectedValue = abi.encodePacked(bytes1(uint8(txReceipt.receiptType)), bytesReceipt);
        }

        bool success = Utils.verifyTrieProof(
            0x270ac2ede5bf10426ffb17cd1a0a46f620011ec92ef53f3afb3e656587a2f747, // receiptsRoot
            txReceipt.keyIndex,
            _getReceiptsProofBranch1(),
            expectedValue
        );

        assertTrue(success);
    }

    function testVerifyTrieProof2() public {
        bytes[] memory receiptProofBranch = new bytes[](3);
        receiptProofBranch[0] =
            hex"f891a074654fba97d83670520e4e54683bcd3afbfa20742acf0bc94916582df9b1eaa9a02aa47f0d484f2ff7b97cf544ce84ed5bb68db970d3c5bd0680d142069ef0d45ba02ca70a54ac0018d930413e4af9b549a801b8ecf3230aba4de397a20404e9141c8080808080a01e44490691f53f3de1413d47a7db3570c621c481816b0f94805c914c398ef8ed8080808080808080";
        receiptProofBranch[1] =
            hex"f90211a0f84cf80ec85666982d618d60961eb864c8bdfcebe56c8f0b772fcf9c97373fdfa083e5b79ab069cb38d97ffa1cc6bae57080971ed6a27bb94ebf0a5c46cd379577a06306af2bc061298e86bf2c5e32aa7f6fa27567fca6269a520cedf0f9a5780bd6a09fbc6e09b3364d24eab44b292d8635168c3a16c28bf5888124cefa5e14a1e23ea02c2f59aeef516d45811ac3bc89d318c3ca4fcefaabefd3131eddbdb95fb68b78a0ddd505432a46d199b30bdde73ff6b8fdac7e00d5d996cc18074b6ce2ef58874da08c155d0e5e3b6eb2c776a84bb8e060802866285f5ded9ee33098b0ea4894a596a0bb45f1da1ca7378583574bd29de91ccb4eaeb730236e6f3ef1eb8f5c6b3c6faaa09b5a73070350cccc4d0da637c42c81fec63861693a522014fcdbd85fe5de27cba05f60c9a17d3d2975972aa1b844d1e4cda203bef645a0e246a1afb5f6f560bc80a04af2e03b087d810e0feffa03e661a281996ff48b2331154a3f6b390ab8d6c9f8a026654e067145eacf7ceebef44ad6336cb20d86a929fb2dfe46f0740ee3a1b917a01122f4853ab32dcb30ddc7218c62a310b45aee840136fa80825b33ef2acfc65ea03afc0dc6b212c01533d1a745b7ed3163f5f7acdcfc4618c8edaf6e8cd95db217a08079c7cb7578a19da5c0d1e456cce944c420b375a98a53e2d442a2b5b7710f8aa089130f7e59e664141c56679c2d6fc2cbdfd57740b8ff09c848324bc0bb62c38a80";
        receiptProofBranch[2] =
            hex"f9033020b9032c02f9032801830d0426b9010000000000000000000000000000000000002000000000000000000000000000040000002000000000001020001000000000000000001008000000000000000000000000000000000000000200000000000000000000002000001000040000008000000000108000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000020000000000400400000000000000000000000000000020000000000000020000000000000000000000000000000000008020000000000004000000000000000080000000000420000000000000000000000000000000000000000000000000000000000000000000000000f9021df89b94c3511006c04ef1d78af4c8e0e74ec18a6e64ff9ef863a09dbb0e7dda3e09710ce75b801addc87cf9d9c6c581641b3275fca409ad086c62a000000000000000000000000093f4c8f670578f6d10bf8b77826f04e9c3a4b9e2a002778d01ac46b081e7ac3b0cb53614b4925e3adb5ec6ab7eb40bd8e615064e47a00000000000000000000000000000000000000000000000000429d069189e0000f9017d94de29d060d45901fb19ed6c6e959eb22d8626708ef884a0db80dd488acf86d17c747445b0eabb5d57c541d3bd7b6b87af987858e5066b2ba0000000000000000000000000c3511006c04ef1d78af4c8e0e74ec18a6e64ff9ea0073314940630fd6dcda0d772d4c972c4e0a9946bef9dabf4ef84eda8ef542b82a002d757788a8d8d6f21d1cd40bce38a8222d70654214e96ff95d8086e684fbee5b8e00000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000004c4170000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000302778d01ac46b081e7ac3b0cb53614b4925e3adb5ec6ab7eb40bd8e615064e470000000000000000000000000000000000000000000000000429d069189e00000000000000000000000000000000000000000000000000000000000000000000";

        TxReceipt memory txReceipt = _getTxReceipt2();

        bytes memory bytesReceipt = Utils.encodeReceipt(txReceipt);
        bytes memory expectedValue = bytesReceipt;
        if (txReceipt.receiptType > 0) {
            expectedValue = abi.encodePacked(bytes1(uint8(txReceipt.receiptType)), bytesReceipt);
        }

        bool success = Utils.verifyTrieProof(
            0x03ad740576271763dfda5d6bce4cb668f44b5d0592b583d2fdbe970b9eb276cc, // receiptsRoot
            txReceipt.keyIndex,
            receiptProofBranch,
            expectedValue
        );

        assertTrue(success);
    }

    function testVerifyTrieProof3() public {
        bytes[] memory receiptProofBranch = new bytes[](3);
        receiptProofBranch[0] =
            hex"f90131a0dc4eb340c97c506352685354b072697c58a46fd0859732d74ac7a2e89d03a67ba0fc41395fa6a7ed43a43c622915a7016dd2e6d26c1e15bffe86935e9d44e318c2a01e2a91ec6127a8c9d83ba35ae79815c654a49971fd24cac6bde4fb0965b2bae4a069f9229570fc548f63bc85673b97bd7b1a7781887740b113a894923ca7e703afa0fe367c8dde446c09301e0e77a8c8b03c10ac8ba5a23540da80132245651bd7a7a0b1375a3d3222187cdf40c1bcba011ac268649a6123abf1bbc41c523be6e6759ba0a4f2fbc5cbc7565084031256f641aad4f96672b7389d1ecbb6bf3eebff73c028a079f6a5cd6288f3393aa1a263f85f345d060bd62fc7f8ee25c0bd313d2ef1d623a0c0f9bc21fd80607feeac50ce29118fe145b078a4902a75a9fac96b191c269d8a8080808080808080";
        receiptProofBranch[1] =
            hex"f901f180a09350a92f9a3fcea6da6a67dde9db1aab57457f97a6abac3da5ab991c6712ce9ca0e95067cd1f97a33362319e21dfa808178991c54a849b644d3374913be0f0064aa0fc622ff7e8f103f7b7bc8f45fe1691659bbcec51a0245ed2737e350f09e5fe67a07a1f79b515638d89423880959f54a6db331d3c69cf27980bd06bea25c79e9de5a01dac1e6505a4645c9e03948f5395abb003b3d89bad68d50886aa1c9668b2b5bea0923b3966a08256fcf5633f7760ef4ee7f0f87dfe8ef052d92e79861ccd286682a0a8a50181ebf208a5cf9bdc92f685c7fa0a05f5c83b5fa835c8d2d7cc2726da42a09cd3d05afbd82e274fd84ffb4cc81a04c9f178a27ba9cd7104c0d336b907cde6a00f02466ad62e0faa503a8eae8a1404da796476817996eea1411475a8cb2a4229a06f375ee36ae9e6c393a81b7315b4f60d89805f081c951f3dc226e65a781ae292a0346a4177227e2f87b4e2aa94591592aa909a3a64e14fc88440a54be7e60e2ed8a063a0c4a30221a28c918691f1cf3d17d8f060b36e197292f8fb985cd965603232a0dc1ab2e922622a6b2076ef74a3a7c960f6fd7b8bf5c57106251709be4696b5b1a05772c661a8ba0b30015497e44c69ba24ca1946395dc5019536bf3295e177565ba070674e739f9d4aa83102166fb9bca9e7daf1ce5efc6967d34436758d9fbf579380";
        receiptProofBranch[2] =
            hex"f9044220b9043e02f9043a01830f7e43b9010000200000000000000000000080000000000100000000000000000000000000000004000000000000000000000000000002000000080100000000000000000000020000080000000000000008000000200000004001000000000000008020000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000001080000080000004000000000000000000000000000000000000000008000000000000000000000000000000000000002000000000000000200000000000020000000001000000000000000000000200000000000000000000000000000001000000008400000000000040000f9032ff87a94c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2f842a0e1fffcc4923d04b559f4d29a8bfc6cda04eb5b0d3c460751c2402c5c5cc9109ca00000000000000000000000003fc91a3afd70395cd496c647d5a6cc9d4b2b7fada0000000000000000000000000000000000000000000000000008e1bc9bf040000f89b94c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2f863a0ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3efa00000000000000000000000003fc91a3afd70395cd496c647d5a6cc9d4b2b7fada0000000000000000000000000105af6ed72d373b685b0a36347be7e08efa87536a0000000000000000000000000000000000000000000000000008e1bc9bf040000f89b9489b16e61e79ff20b0cf0026ea10a12b74bd3ccc0f863a0ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3efa0000000000000000000000000105af6ed72d373b685b0a36347be7e08efa87536a000000000000000000000000073e2ececad90d5e3b8a649220394d239665db05ba00000000000000000000000000000000000000000000000000001212d169919adf87994105af6ed72d373b685b0a36347be7e08efa87536e1a01c411e9a96e071241c2f21f7726b17ae89e3cab4c78be50e062b03a9fffbbad1b840000000000000000000000000000000000000000000000000005b3e0efab536850000000000000000000000000000000000000000000000002d426b7e0ea2bab4f8fc94105af6ed72d373b685b0a36347be7e08efa87536f863a0d78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822a00000000000000000000000003fc91a3afd70395cd496c647d5a6cc9d4b2b7fada000000000000000000000000073e2ececad90d5e3b8a649220394d239665db05bb8800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008e1bc9bf0400000000000000000000000000000000000000000000000000000001212d169919ad0000000000000000000000000000000000000000000000000000000000000000";

        TxReceipt memory txReceipt = _getTxReceipt3();

        bytes memory bytesReceipt = Utils.encodeReceipt(txReceipt);
        bytes memory expectedValue = bytesReceipt;
        if (txReceipt.receiptType > 0) {
            expectedValue = abi.encodePacked(bytes1(uint8(txReceipt.receiptType)), bytesReceipt);
        }

        assertEq(
            keccak256(expectedValue.toRlpItem().toRlpBytes()),
            0x266e59d6fb48f7a1abfb141af24de82a9502aa878efd3dfc8469d3355c204658 // receipt hash
        );

        bool success = Utils.verifyTrieProof(
            0x109d5c51f422cbbfaf1efe27466ecf9137cdc65be8325d99f4bdfa8123565282, //root
            txReceipt.keyIndex,
            receiptProofBranch,
            expectedValue
        );

        assertTrue(success);
    }

    function testVerifyTrieProof4() public {
        bytes[] memory receiptProofBranch = new bytes[](3);
        receiptProofBranch[0] =
            hex"f8d1a0e7e4e1d287e990d928e91eac9a4cedca394a8be3931f23d206c2dc42f2a83ca3a007e365c5ce452ef0feaf230fd76108fa9544a23192c8f80b4085d836a2225e41a07e1505273dab2e40538b4dc1e62bb4c948906fa5e6d9a4656670fb11514306c8a09153af6ab1ce50d33e70405ffc7383281659da0618f3cc623feef1b88b89f16ea0e89ace6a049d831c6e69ac8f845620af9c60da7ece855cfeee71a964edf1e2eb808080a0e58215be848c1293dd381210359d84485553000a82b67410406d183b42adbbdd8080808080808080";
        receiptProofBranch[1] =
            hex"f901f180a0b54775a99637d46fe23c7f1a069a58ce88c22bdb6d43fa50f2dde9c6eede4781a0af9409cd88788b47541a2fb62976c58d04254bb9b1fb1f2ddd2c1c74b6b66d13a03623454f6d8a2f948b0fd89d518c9cb3242db1f9c28716c8b53a5dc6f555e093a0f7ad6c28f82d86f05c5d7f19c1fbdce6378ca9101e9d4cecb77fdd96560bd51ea05cc16bffffa61a7742b925e2a27c49c2b5acc1668075484f43e69b1fa44f7689a0d34b03235432abbdd0a3c41ab34b4c73a77ff01f19156d501d55f80cb79cc9daa0cd436d44ab9039196fdb4c6a465414ab8bae246c3643eaeefa7c0db1a7148820a0520b1498c221479f544799d6b1ad9a0813af6c7e7194ae92153cfa89e62ef27ea018d9047bac24390846f38d84e09db7305c919b6b8321484b9888c6867202b806a0b0da8087898c4debfe6dc4fd857550100762f07391e738bb6f9a679c9b28a27fa054b6aa94ef9436b734117a84ac41944ff0c92ecfbfff360e18db1718530d7a42a04691700e4e915807dddec6f40e693673ffb84ee35cac8c531bbce52708cd48a1a0e8679eda80264850713f9c14f2d64cc21bf996c522c04f20f8f87972a95b5e70a0480c81a39a4e81cdd1d784b097ccdca7ec1275e5861b03f5289d44192ca21c16a03da997586f7b776321e2ace44799006dac5d91d4dbd7e42ed3315fcb046bbf9f80";
        receiptProofBranch[2] =
            hex"f901ae20b901aaf901a70183011b2ab9010000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000200000000000000000000002000000000000000000000000000008000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000010000080000000000040000000000000000020000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000f89df89b94499d11e0b6eac7c0593d8fb292dcbbf815fb29aef863a0ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3efa0000000000000000000000000e84d601e5d945031129a83e5602be0cc7f182cf3a0000000000000000000000000e041593d11bbabfa3af4191eba6829359c77a6a4a00000000000000000000000000000000000000000000000000de0b6b3a7640000";

        TxReceipt memory txReceipt = _getTxReceipt4();

        bytes memory bytesReceipt = Utils.encodeReceipt(txReceipt);
        bytes memory expectedValue = bytesReceipt;
        if (txReceipt.receiptType > 0) {
            expectedValue = abi.encodePacked(bytes1(uint8(txReceipt.receiptType)), bytesReceipt);
        }

        bool success = Utils.verifyTrieProof(
            0x1026f7f0ca1c5c9740019d0c25f4c92a7cfc96388a8f1c03d8e17e871274ae76, // receiptsRoot
            txReceipt.keyIndex,
            receiptProofBranch,
            expectedValue
        );

        assertTrue(success);
    }

    function testProveTransactionInclusion1() public {
        blockhashStorage.setBlockHash(
            uint256(0x10d2ca6), 0x1f2274b771312ed973f587848c0e06d43445f92e93acdb52b3ac1b6b008c96a4
        );

        BlockData memory blockData = BlockData({
            parentHash: hex"a71d7d395fa99c10dabcf5727575137127baee8a21f6d7edcd5e39b6dad1d66f",
            sha3Uncles: hex"1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",
            miner: 0x388C818CA8B9251b393131C08a736A67ccB19297,
            stateRoot: hex"5fe4dcd7db1f782670184adea5d1eefafa4525fdfd73e2bd3f2231dd7cdaf12e",
            transactionsRoot: hex"820a34c3ff9154472a50386f196fc779a8c44403919e4d33712d86f35e50516f",
            receiptsRoot: hex"270ac2ede5bf10426ffb17cd1a0a46f620011ec92ef53f3afb3e656587a2f747",
            logsBloom: hex"3c3d531e492e5339bd088cc1ce28d2695acb52064b17062941a3800e7c62080cc15599aa481913f972193b8364500b006f0dc2bcbe29f8a05685b8a6b12cb9808bf6d0182276184f2a1a440cbf28746e04295cc70d463a3a0b020e7aab6f872b02488a4a8340ee014156a39058663b29e51c2b5692a84444fa045858288f8dba0b0286784fe980943c4a4c15a35284669698b4e9ebc6e4ccc8b50f634c547966a2a151e3ebd462a25a00e6e6fbee17a4e4544875a2d80aab397b19ca4a0d92c46536c052848fc560821aa4c08c2c72b598cd75b2dca4095c85525f8e1c50f2ad163becabc163c44f86f516be08e468c0e461f226cfb0aa47c07d249c000ff4e7",
            difficulty: uint256(0x0),
            number: uint256(0x10d2ca6),
            gasLimit: uint256(0x1c9c380),
            gasUsed: uint256(0xe2f507),
            timestamp: uint256(0x64a7c6a7),
            extraData: hex"6265617665726275696c642e6f7267",
            mixHash: hex"8da2671e1312eea46891ffa353d09ad2f139ab16c079b2b212d9cf4c63211f24",
            nonce: hex"0000000000000000",
            baseFeePerGas: uint256(0x7a03f8e35),
            withdrawalsRoot: hex"c3be3075835092bcc3a000b8a0ecf4f6e80b63eeaeb09a569af77cff483d1ea9"
        });

        ProverDto memory data = ProverDto({
            blockData: blockData,
            txReceipt: _getTxReceipt1(),
            blockNumber: uint256(0x10d2ca6),
            receiptProofBranch: _getReceiptsProofBranch1()
        });

        assertTrue(prover.proveTransactionInclusion(data));
    }

    function testProveTransactionInclusion5_zeroStateRoot() public {
        blockhashStorage.setBlockHash(
            uint256(0x10d2ca3), 0xf8591b5b4e4f7fe47b7adeff8f0113f9e5ce304e3b0539e8a45148473b471f62
        );

        BlockData memory blockData = BlockData({
            parentHash: hex"e0e99e5629c622a14d8bc62154f83a2830fe78daa2b074130c1822f0106c391b",
            sha3Uncles: hex"1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",
            miner: 0xeBec795c9c8bBD61FFc14A6662944748F299cAcf,
            stateRoot: hex"0eee2ad48b334bea33d56dd43674fe442116efe09548743b6742ca2da3978fb6",
            transactionsRoot: hex"a552cb1836fc6e603706129b0b1c3cbbe154f256b8242d6f9402c7b92b9e9754",
            receiptsRoot: hex"70ac9c3b5ee026e7dfd5333e4a94e27ebf767212c0c79d33cc901cd07c21eab5",
            logsBloom: hex"632507c108a5e872ed8ca29ba3d0de439d0370e92f390289691d656ff82aea388114b1e56207327657191af3381d2fb48b2d870bee0e3c14378b0220a76c2949c3653acbd3125bef4b61dcaba03e72ab887e90e445c268410794d361d8f81fd0d7c431632282792bd5dfd8c411982c55d41224a0f5244ccdc44c1cbec46e11874924a77f2b68d9811ceac4d853e8047ea0278e89a9066bfa848c02f7f753d9fba359c4627d0aef51feee45fca4918711eef4046026e63b799be58e19042c6a52fbfb12367c4fc85a85059520804f33a64c77db5afa0a81b2e9d2559f8000f3b5b7f6b2885da04ccd97e535eec8e48d72876b1710e22c88d0088839fca905fcdf",
            difficulty: uint256(0x0),
            number: uint256(0x10d2ca3),
            gasLimit: uint256(0x1c9c380),
            gasUsed: uint256(0xdf2716),
            timestamp: uint256(0x64a7c683),
            extraData: hex"6265617665726275696c642e6f7267",
            mixHash: hex"9fedeb693abbb38950e7646e46469398fbf5aa3901258e6215e7b71bc5860f11",
            nonce: hex"0000000000000000",
            baseFeePerGas: uint256(0x7b89ea02a),
            withdrawalsRoot: hex"72b2211cb337dc2c6ff78a3358278bd6772f356f07d0702f05f83170e1a7bc5d"
        });

        ProverDto memory data = ProverDto({
            blockData: blockData,
            txReceipt: _getTxReceipt5(),
            blockNumber: uint256(0x10d2ca3),
            receiptProofBranch: _getReceiptsProofBranch5()
        });

        assertTrue(prover.proveTransactionInclusion(data));
    }

    // TxReceipts Data
    function _getTxReceipt1() private pure returns (TxReceipt memory) {
        TxLog[] memory logs = new TxLog[](1);

        // TxLog 0
        bytes[] memory topics1 = new bytes[](3);
        topics1[0] = hex"ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef";
        topics1[1] = hex"000000000000000000000000456325f2ac7067234dd71e01bebe032b0255e039";
        topics1[2] = hex"000000000000000000000000ed69601414a0a95cee219bc06e674b62ded66247";

        logs[0] = TxLog({
            addr: 0xdAC17F958D2ee523a2206206994597C13D831ec7,
            topics: topics1,
            data: hex"000000000000000000000000000000000000000000000000000000001c4e3047"
        });

        TxReceipt memory txReceipt = TxReceipt({
            receiptType: 0,
            postStateOrStatus: 1,
            cumulativeGasUsed: uint256(0x357dd5),
            keyIndex: hex"0104",
            bloom: hex"00000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000008200000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000100000000000000000000002000080000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000008000000000000020000000000000000000000000000000",
            logs: logs
        });

        return txReceipt;
    }

    function _getTxReceipt2() private pure returns (TxReceipt memory) {
        TxLog[] memory logs = new TxLog[](2);

        // TxLog 0
        bytes[] memory topics1 = new bytes[](3);
        topics1[0] = hex"9dbb0e7dda3e09710ce75b801addc87cf9d9c6c581641b3275fca409ad086c62";
        topics1[1] = hex"00000000000000000000000093f4c8f670578f6d10bf8b77826f04e9c3a4b9e2";
        topics1[2] = hex"02778d01ac46b081e7ac3b0cb53614b4925e3adb5ec6ab7eb40bd8e615064e47";

        logs[0] = TxLog({
            addr: 0xc3511006C04EF1d78af4C8E0e74Ec18A6E64Ff9e,
            topics: topics1,
            data: hex"0000000000000000000000000000000000000000000000000429d069189e0000"
        });

        // TxLog 1
        bytes[] memory topics2 = new bytes[](4);
        topics2[0] = hex"db80dd488acf86d17c747445b0eabb5d57c541d3bd7b6b87af987858e5066b2b";
        topics2[1] = hex"000000000000000000000000c3511006c04ef1d78af4c8e0e74ec18a6e64ff9e";
        topics2[2] = hex"073314940630fd6dcda0d772d4c972c4e0a9946bef9dabf4ef84eda8ef542b82";
        topics2[3] = hex"02d757788a8d8d6f21d1cd40bce38a8222d70654214e96ff95d8086e684fbee5";

        logs[1] = TxLog({
            addr: 0xde29d060D45901Fb19ED6C6e959EB22d8626708e,
            topics: topics2,
            data: hex"0000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000004c4170000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000302778d01ac46b081e7ac3b0cb53614b4925e3adb5ec6ab7eb40bd8e615064e470000000000000000000000000000000000000000000000000429d069189e00000000000000000000000000000000000000000000000000000000000000000000"
        });

        TxReceipt memory txReceipt = TxReceipt({
            receiptType: 2,
            postStateOrStatus: 1,
            cumulativeGasUsed: 853030,
            keyIndex: hex"0103",
            bloom: hex"00000000000000000000000000000000002000000000000000000000000000040000002000000000001020001000000000000000001008000000000000000000000000000000000000000200000000000000000000002000001000040000008000000000108000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000020000000000400400000000000000000000000000000020000000000000020000000000000000000000000000000000008020000000000004000000000000000080000000000420000000000000000000000000000000000000000000000000000000000000000000000000",
            logs: logs
        });

        return txReceipt;
    }

    function _getTxReceipt3() private pure returns (TxReceipt memory) {
        TxLog[] memory logs = new TxLog[](5);

        // TxLog 0
        bytes[] memory topics1 = new bytes[](2);
        topics1[0] = hex"e1fffcc4923d04b559f4d29a8bfc6cda04eb5b0d3c460751c2402c5c5cc9109c";
        topics1[1] = hex"0000000000000000000000003fc91a3afd70395cd496c647d5a6cc9d4b2b7fad";

        logs[0] = TxLog({
            addr: 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2,
            topics: topics1,
            data: hex"000000000000000000000000000000000000000000000000008e1bc9bf040000"
        });

        // TxLog 1
        bytes[] memory topics2 = new bytes[](3);
        topics2[0] = hex"ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef";
        topics2[1] = hex"0000000000000000000000003fc91a3afd70395cd496c647d5a6cc9d4b2b7fad";
        topics2[2] = hex"000000000000000000000000105af6ed72d373b685b0a36347be7e08efa87536";

        logs[1] = TxLog({
            addr: 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2,
            topics: topics2,
            data: hex"000000000000000000000000000000000000000000000000008e1bc9bf040000"
        });

        // TxLog 3
        bytes[] memory topics3 = new bytes[](3);
        topics3[0] = hex"ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef";
        topics3[1] = hex"000000000000000000000000105af6ed72d373b685b0a36347be7e08efa87536";
        topics3[2] = hex"00000000000000000000000073e2ececad90d5e3b8a649220394d239665db05b";

        logs[2] = TxLog({
            addr: 0x89B16e61e79Ff20b0cf0026eA10a12b74BD3CcC0,
            topics: topics3,
            data: hex"0000000000000000000000000000000000000000000000000001212d169919ad"
        });

        // TxLog 4
        bytes[] memory topics4 = new bytes[](1);
        topics4[0] = hex"1c411e9a96e071241c2f21f7726b17ae89e3cab4c78be50e062b03a9fffbbad1";

        logs[3] = TxLog({
            addr: 0x105AF6eD72D373B685B0A36347Be7E08eFA87536,
            topics: topics4,
            data: hex"000000000000000000000000000000000000000000000000005b3e0efab536850000000000000000000000000000000000000000000000002d426b7e0ea2bab4"
        });

        // TxLog 5
        bytes[] memory topics5 = new bytes[](3);
        topics5[0] = hex"d78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822";
        topics5[1] = hex"0000000000000000000000003fc91a3afd70395cd496c647d5a6cc9d4b2b7fad";
        topics5[2] = hex"00000000000000000000000073e2ececad90d5e3b8a649220394d239665db05b";

        logs[4] = TxLog({
            addr: 0x105AF6eD72D373B685B0A36347Be7E08eFA87536,
            topics: topics5,
            data: hex"0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008e1bc9bf0400000000000000000000000000000000000000000000000000000001212d169919ad0000000000000000000000000000000000000000000000000000000000000000"
        });

        TxReceipt memory txReceipt = TxReceipt({
            receiptType: 2,
            postStateOrStatus: 1,
            cumulativeGasUsed: uint256(0xf7e43),
            keyIndex: hex"0005",
            bloom: hex"00200000000000000000000080000000000100000000000000000000000000000004000000000000000000000000000002000000080100000000000000000000020000080000000000000008000000200000004001000000000000008020000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000001080000080000004000000000000000000000000000000000000000008000000000000000000000000000000000000002000000000000000200000000000020000000001000000000000000000000200000000000000000000000000000001000000008400000000000040000",
            logs: logs
        });

        return txReceipt;
    }

    function _getTxReceipt4() private pure returns (TxReceipt memory) {
        TxLog[] memory logs = new TxLog[](1);

        // TxLog 0
        bytes[] memory topics1 = new bytes[](3);
        topics1[0] = hex"ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef";
        topics1[1] = hex"000000000000000000000000e84d601e5d945031129a83e5602be0cc7f182cf3";
        topics1[2] = hex"000000000000000000000000e041593d11bbabfa3af4191eba6829359c77a6a4";

        logs[0] = TxLog({
            addr: 0x499d11E0b6eAC7c0593d8Fb292DCBbF815Fb29Ae,
            topics: topics1,
            data: hex"0000000000000000000000000000000000000000000000000de0b6b3a7640000"
        });

        TxReceipt memory txReceipt = TxReceipt({
            receiptType: 0,
            postStateOrStatus: 1,
            cumulativeGasUsed: 72490,
            keyIndex: hex"0001",
            bloom: hex"00000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000200000000000000000000002000000000000000000000000000008000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000010000080000000000040000000000000000020000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000",
            logs: logs
        });

        return txReceipt;
    }

    function _getTxReceipt5() private pure returns (TxReceipt memory) {
        TxLog[] memory logs = new TxLog[](0);

        TxReceipt memory txReceipt = TxReceipt({
            receiptType: 0,
            postStateOrStatus: 1,
            cumulativeGasUsed: uint256(0x37ca76),
            keyIndex: hex"010f",
            bloom: hex"00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
            logs: logs
        });

        return txReceipt;
    }

    function _getReceiptsProofBranch1() private pure returns (bytes[] memory) {
        bytes[] memory receiptProofBranch = new bytes[](3);
        receiptProofBranch[0] =
            hex"f90131a097b47d95d9e48e0744cc443f9c22e69337aec7f5d7206835c9f5d43ad47aa91ba0e7db8426328c1020504662a646418dabece7cc4d3167dc0ede6b3a8db8e88407a0dec8465c2e83c68214faeadbe8a1af1b0d5399808e8b00c35495e57dfa4a9b50a0a9bb7e9c5c2307cf970ac195c560361f87b94eeb3851bb55a0c385eb77e17cb2a0e704c504f5336392754c86756a6bbdac4be00f09486f4043eed0f227d4ae44c3a006139c65dc1142ff48dde54838658285896476f4544dd3159bc297309610d0b5a00726217318538a9f490a48b0ab76d64b72860cb031258a5031a927f0df33a9a1a0ab464a9b89df117b1e32a9a5938f2f50a5196fd9cdc04682b6b30988d05713a2a0bdd567b8678f37434c551e126ef14c8ac9f9e65facbc4c937c62b31c82cf38e38080808080808080";
        receiptProofBranch[1] =
            hex"f90211a0e3b95cac8d8e50df87c80593803e25e32768d0c756288562388b62944d2ccbf2a038200f7419ff6d1debb665299f8f98c7b5ba83a575f1455f964866b629679209a05243df9e34786b4b168f0156b1fa984bc2f41cc847ad7c58fc0ecb07ea8354e5a09a543125627cf20593589f7302c4728251d5399f75992be3eaaa6f88663b13f6a01ae2c355c9f10bc6718dac011fae15b651815a39b715b075c4492643f087cb08a06ea9cdf151ea5a762edb79c52ff8f439198ece232764eb9bb4f72e60e2f5627ea09c787537e35ba4d19c8b726fc08437d8260ae7536caa68dc9bbe09546307fa8ca0cc78df9157180162ffeef6f11e95e3469029470d2af43087cde7c88fe610c0f2a079a89c0f3eb30757b45b8ec6000166bdbde1fc328db119f52c5aa5675523d14ea00c0412b0924d31fea9487ddc67a2b92a751070e261c7d16493d185c49d3961afa07cb93589881235d6f88a9176a02338ff841b411ad714d09a0e40365182de9375a0ed6fff813fd55307a9cb7da6a7fd6b401c82e1184be7e20d73a368fa7fd3dc02a0f7c0b76c277cc5d55d14ad7210738cbfe4085ba3d90d92dd560f6d49fe0ac5e7a0b05d95be4f492ee8016967142e04d0a23da12fd41bb7091210ff625d133980daa04421b80531bc51f5e1a302c4198ee0746de4476fd216737f718b68d4cd03132ba0ba299e926ad40b7815faae221aacc22b30ea8a7d052eee5c5b897eb1f67b8ec180";
        receiptProofBranch[2] =
            hex"f901ae20b901aaf901a70183357dd5b9010000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000008200000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000100000000000000000000002000080000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000008000000000000020000000000000000000000000000000f89df89b94dac17f958d2ee523a2206206994597c13d831ec7f863a0ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3efa0000000000000000000000000456325f2ac7067234dd71e01bebe032b0255e039a0000000000000000000000000ed69601414a0a95cee219bc06e674b62ded66247a0000000000000000000000000000000000000000000000000000000001c4e3047";
        return receiptProofBranch;
    }

    function _getReceiptsProofBranch5() private pure returns (bytes[] memory) {
        bytes[] memory receiptProofBranch = new bytes[](3);
        receiptProofBranch[0] =
            hex"f90131a09fb182ca511c5b74ca2fb656df0cc4d66932cd8d59fa3197d0efbcc2267d84d2a0aebb9d00d018d4db66103f113599b3012391f47b0013a70bfbfe5dd70b039133a0a849d3f91719a9cfe1a4cad02414f3d9f1858df5b0dfd23bbd28d5ca5df70579a046e44f636018890323ae80025f5680bb485790ce9c8b388314bce5005f01b023a0c0e086f86c408e241a3ed45ce88d3c94c4cfceca4d7d3d848db65d9c46a6262ba0ce0e4dfd228be588fff1ee5938befaf03e6169fa42906b17baa9bfe6d02065afa0e7fa3025721968ab497e2feabc0830c34a10aba022bda132163f453c045aa868a00f4ac074a86ac8cb1a84df7f1ba8a6707c841a50f5e2f70b1bc627db36bd5e83a0d49fa49ea74f1f076186092f545bd8062dfaf1abd318214bba154d23ed75b2908080808080808080";
        receiptProofBranch[1] =
            hex"f90211a03655a10edaaba3ebf962f694eaf583e719102a0b6f0717c04447a8892f7016d1a01b19c34da36c5128aa6b92992970165a854fe170d113cdaa18373e8d3e39f81aa050cb6d5ed9c1145e528f3dccdf7f67f12792c12d38bcee0515c9b167b4d78864a07fcc6f3d74ba68a0092ed448936b7f24e589ad8e8839ce8f95243e1768034424a060635a54e6342557b82be63fce20831bea77052949afbd8aff75d87a09feaa2ba00634ce995403ee86513dc48ee40879134ae144fe6078eee1a0e7513b4893d80fa01759aed95700404a7d81438457141165a37adf8b93a255803721322614dbfa13a052d096eabd159594f5f6cea6c1d626a63fd4f2643ad9d74d7d3e9cef761cbbd8a013e9ae1e0fe237dcbd431ef043b5d61c611c0b6f2973f0b23d2137c87598ddcda05f23b849067714dd08d4520dfe1cdb352945a66280376622c806b3f91bf2085ea0c87d96d27b7098278f55e53f09027b33699ce5bf6c1579d2c687c4e16fb8d932a08936c371f4a6c3b46675d7077d29aa7c058eecf2823219ea491b11a15a161d7ba023c3f47c7ac3d22ecdcf7b546e44cc58ec49c6eee80fd8667fee882fa4870f6aa0e753703bec86ea62eb5b6ba3920d36267a6a138c3c4f0d7a34596d38cba79d59a08895cc8873f6e2ea551ff2a680a578de12fd99bd94173e5de9ac1b38d9ee7841a0bf9f4b38f52c87c6fc5894ce1cc9a7f9156de7e9e06a05b9c05d2cfa038647ff80";
        receiptProofBranch[2] =
            hex"f9011020b9010cf90109018337ca76b9010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c0";
        return receiptProofBranch;
    }
}
